# Migration `20200820013147-development`

This migration has been generated by David Blass at 8/19/2020, 9:31:47 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `db`.`User` (
`id` int  NOT NULL  AUTO_INCREMENT,
`email` varchar(191)  NOT NULL ,
`password` varchar(191)  NOT NULL ,
`first` varchar(191)  NOT NULL ,
`last` varchar(191)  NOT NULL ,
UNIQUE Index `User.email_unique`(`email`),
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `db`.`Test` (
`id` int  NOT NULL  AUTO_INCREMENT,
`userId` int  NOT NULL ,
`name` varchar(191)  NOT NULL ,
UNIQUE Index `Test.name_userId_unique`(`name`,
`userId`),
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `db`.`Tag` (
`id` int  NOT NULL  AUTO_INCREMENT,
`userId` int  NOT NULL ,
`name` varchar(191)  NOT NULL ,
`testId` int  ,
UNIQUE Index `Tag.name_userId_unique`(`name`,
`userId`),
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `db`.`Step` (
`id` int  NOT NULL  AUTO_INCREMENT,
`kind` ENUM('click', 'set', 'hover', 'key', 'go', 'screenshot', 'assertText', 'assertVisibility')  NOT NULL ,
`selector` varchar(191)  ,
`value` varchar(191)  ,
`key` varchar(191)  ,
`url` varchar(191)  ,
`expected` varchar(191)  ,
`userId` int  ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `db`.`_StepToTest` (
`A` int  NOT NULL ,
`B` int  NOT NULL ,
UNIQUE Index `_StepToTest_AB_unique`(`A`,
`B`),
Index `_StepToTest_B_index`(`B`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

ALTER TABLE `db`.`Test` ADD FOREIGN KEY (`userId`) REFERENCES `db`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `db`.`Tag` ADD FOREIGN KEY (`userId`) REFERENCES `db`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `db`.`Tag` ADD FOREIGN KEY (`testId`) REFERENCES `db`.`Test`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `db`.`Step` ADD FOREIGN KEY (`userId`) REFERENCES `db`.`User`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `db`.`_StepToTest` ADD FOREIGN KEY (`A`) REFERENCES `db`.`Step`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `db`.`_StepToTest` ADD FOREIGN KEY (`B`) REFERENCES `db`.`Test`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200820013147-development
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,70 @@
+datasource dev {
+  provider = "mysql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+  // binaryTargets = ["native", "rhel-openssl-1.0.x"]
+  output   = "./client"
+}
+
+generator typegraphql {
+  provider = "node node_modules/typegraphql-prisma/generator.js"
+  output   = "../src/schema/generated"
+}
+
+model User {
+  id       Int    @id @default(autoincrement())
+  email    String @unique
+  password String
+  first    String
+  last     String
+  steps    Step[]
+  tags     Tag[]
+  tests    Test[]
+}
+
+model Test {
+  id     Int    @id @default(autoincrement())
+  user   User   @relation(fields: [userId], references: [id])
+  userId Int
+  name   String
+  steps  Step[]
+  tags   Tag[]
+  @@unique([name, userId])
+}
+
+model Tag {
+  id     Int    @id @default(autoincrement())
+  user   User   @relation(fields: [userId], references: [id])
+  userId Int
+  name   String
+  @@unique([name, userId])
+  Test   Test? @relation(fields: [testId], references: [id])
+  testId Int?
+}
+
+model Step {
+  id       Int      @id @default(autoincrement())
+  kind     StepKind
+  selector String?
+  value    String?
+  key      String?
+  url      String?
+  expected String?
+  tests    Test[]
+  User     User?    @relation(fields: [userId], references: [id])
+  userId   Int?
+}
+
+enum StepKind {
+  click
+  set
+  hover
+  key
+  go
+  screenshot
+  assertText
+  assertVisibility
+}
```


